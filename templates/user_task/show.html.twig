{% extends 'base.html.twig' %}

{% block title %}Task Details{% endblock %}

{% block body %}
    {% include "main/page_header.html.twig" with {
        page_title: 'Task Details',
        actions: [
            {
                action_route: 'user_task_edit',
                action_class: 'info',
                label: 'edit task',
                link_options: { id: user_task.id },
            },{
                action_route: 'user_task_new',
                action_class: 'success',
                label: 'new task',
            },{
                action_route: 'report',
                action_class: 'dark',
                label: 'generate report',
            },{
                action_route: 'user_task_index',
                action_class: 'primary',
                label: 'back to tasks list',
                link_class: 'light',
            },
        ]
    } %}
    <div class="row mb-3">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">{{ user_task.title }} <span class="small float-right"><span class="small">priority </span><span class="text-{{ user_task.priority == 1 ? 'danger' : user_task.priority == 2 ? 'warning' : 'info' }}">{{ user_task.priority == 1 ? 'high' : user_task.priority == 2 ? 'med' : 'low' }}</span></span></h4>
                    <div class="card-text">
                    <div>{{ user_task.description|raw }}</div>
                    <p class="row">
                        <span class="col">Start {{ user_task.startDate ? user_task.startDate|date('F j Y') : '' }}</span> |
                        <span class="col">Due {{ user_task.dueDate ? user_task.dueDate|date('F j Y') : '' }}</span> |
                        <span class="col">Completed {{ user_task.completionDate ? user_task.completionDate|date('F j Y') : '' }}</span>
                    </p>
                    <p></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-3">
        <div class="col-12">
            <div class="card-columns">
                {% for milestone in user_task.taskMilestones %}
                <a href="{{path('task_milestones_edit', {id: milestone.id, referer: path('user_task_show', {id: user_task.id})})}}" class="text-light">
                <div class="card bg-{{milestone.completed is null ? 'warning' : milestone.completed == 'true' ? 'success' : 'warning'}}">
                    <div class="card-body">
                        <h4 class="card-text">{{ milestone.title }}</h4>
                    </div>
                </div>
                </a>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="row float-left offset-md-5">
        <div id="pomotimer" class="col">
            <div id="countdown-timer" class="bg-danger text-center display-4 text-light p-5 border-bottom border-dark rounded-egg rounded-circle">
                <span id="pomoTimeMinutes"></span>:<span id="pomoTimeSeconds">00</span>
            </div>
            <div id="control-buttons" class="col-12 btn-group px-0">
                <button id="startPomo" class="btn btn-sm btn-success">Start</button>
                <button id="stopPomo" class="btn btn-sm btn-warning d-none">Stop</button>
                <button id="resetPomo" class="btn btn-sm btn-info d-none">Reset</button>
            </div>
        </div>
    </div>
    {% if is_granted('ROLE_ADMIN') %}
        {{ include('user_task/_delete_form.html.twig') }}
    {% endif %}
{% endblock %}
{% block javascripts %}
    {{ encore_entry_script_tags('pomo') }}
{% endblock %}